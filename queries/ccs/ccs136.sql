SELECT COUNT(*) as agg_0, MAX("yearmonth"."Consumption") as agg_1, MAX("transactions_1k"."Amount") as agg_2 FROM "customers" LEFT OUTER JOIN "transactions_1k" ON "customers"."CustomerID" = "transactions_1k"."CustomerID" LEFT OUTER JOIN "gasstations" ON "transactions_1k"."GasStationID" = "gasstations"."GasStationID" LEFT OUTER JOIN "yearmonth" ON "customers"."CustomerID" = "yearmonth"."CustomerID"  WHERE "transactions_1k"."Price" >= 46.6867894189197 AND ("gasstations"."Segment" IN ('Other', 'Discount') OR "gasstations"."ChainID" <= 21 OR "gasstations"."Segment" IN ('Discount', 'Noname', 'Premium', 'Value for money'))