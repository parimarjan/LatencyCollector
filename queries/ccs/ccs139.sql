SELECT MAX("transactions_1k"."CustomerID" + "gasstations"."GasStationID") as agg_0 FROM "yearmonth" LEFT OUTER JOIN "customers" ON "yearmonth"."CustomerID" = "customers"."CustomerID" LEFT OUTER JOIN "transactions_1k" ON "customers"."CustomerID" = "transactions_1k"."CustomerID" LEFT OUTER JOIN "gasstations" ON "transactions_1k"."GasStationID" = "gasstations"."GasStationID" LEFT OUTER JOIN "products" ON "transactions_1k"."ProductID" = "products"."ProductID"  WHERE ("products"."ProductID" >= 489 OR ("products"."ProductID" >= 472 AND "products"."ProductID" BETWEEN 214 AND 447)) AND "transactions_1k"."TransactionID" <= 396 AND "transactions_1k"."Date" IN ('2012-08-23')