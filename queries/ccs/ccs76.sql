SELECT AVG("yearmonth"."CustomerID") as agg_0 FROM "yearmonth" LEFT OUTER JOIN "customers" ON "yearmonth"."CustomerID" = "customers"."CustomerID"  WHERE "yearmonth"."CustomerID" <= 1272362 AND "yearmonth"."Date" BETWEEN 201207 AND 201304 AND ("customers"."Currency" IN ('EUR') OR "customers"."CustomerID" BETWEEN 248741 AND 863596 OR "customers"."Currency" != 'EUR') AND "customers"."Segment" IN ('KAM', 'LAM')